<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="layout">
<tal:block metal:fill-slot="main">
    <!-- Main hero unit for a primary marketing message or call to action -->
    <div class="row">
        <div class="span12">
            <div id="view_titles">
                <h1>${archive.label}</h1>
                <h3 tal:condition="archive.site">${archive.site}</h3>
                <p><em>${archive.time.strftime("%c")}, uploaded by ${archive.submitter_name}</em></p>
            </div>
            <form id="edit_titles" action="${request.route_url('check', archive_id=archive.id)}" method="post" hidden>
                <input class="form-h1 span12" name="label" placeholder="Label" value="${archive.label}" />
                <div class="row">
                    <div class="span7" style="text-align:left;">
                        <input class="form-h3 span7" name="site" placeholder="Site" value="${archive.site}" />
                    </div>
                    <div class="span5" style="text-align:right; margin-top:12px;">
                        <select name="archive_type" id="archiveType">
                            <option tal:repeat="type archive_types" value="${type}" tal:attributes="selected 'selected' if type==archive.archive_type else None">
                                ${type.replace("_", " ")}
                            </option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <p class="span8"><em>${archive.time.strftime("%c")}, uploaded by ${archive.submitter_name}</em></p>
                    <div class="span4" style="text-align: right;">
                        <button id="cancel" class="btn">Cancel</button>
                        <input type="submit" class="btn btn-primary" value="Save Changes" />
                    </div>
                </div>
            </form>
            <div class="form-actions">
                <div class="pull-left">
                    <a class="btn btn-success" href="/archives/${basename}/archive.zip"><i class="icon-arrow-down icon-white"></i> Download Archive</a>
                    <a class="btn" href="/archives/${basename}/"><i class="icon-folder-open"></i> View Files</a>
                    <a id="edit" class="btn" href="#"><i class="icon-pencil"></i> Edit</a>
                    <a class="btn" href="/check/${archive.id}/rerun" ><i class="icon-repeat"></i> Re-run Tests</a>
                </div>
                <div class="pull-right">
                    <a class="btn btn-danger" href="/check/${archive.id}/super_delete"><i class="icon-trash icon-white"></i> Super Delete</a>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <h2 class="span12">Status: ${archive.status}</h2>
        <div class="span12">
            <table id="test-summary" class="table table-striped">
                <thead>
                    <tr>
                        <th>Test</th><th>Status</th><th>Details</th>
                    </tr>
                </thead>
                <tbody>
                    <tr tal:repeat="test archive.diagnostics">
                        <td>${test.name.replace("_", " ")}</td>
                        <td>
                            <span class="label label-${status_highlights.get(test.status, '')}">${test.status}</span>
                        </td>
                        <td>
                            <p class="details" tal:content="structure test.details"></p>
                            <div class="links">
                                <div><a tal:condition="test.html" href="${request.static_url(test.html)}">Results</a></div>
                                <div><a tal:condition="test.readme" href="${request.route_url('test_readme', test_name=test.name)}">Readme</a></div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</tal:block>
<tal:block metal:fill-slot="extra_head">
    <script>
        $(function(){
            $("#edit, #cancel").click(function(){
                $("#view_titles").toggle();
                $("#edit_titles").toggle();
                return false;
            });
        });
    </script>
</tal:block>
</html>
